Детектор атак DDoS
Демон основан на фреимворке netmap. Слушает весь трафик на 10Гб интерфейсе сервера, в который зеркалируется весь трафик сети (либо только входящий). Каждый полученный пакет на этом интерфейсе разбирается и проверяется по списку правил. Если пакет совпадает с каким-то правилом - срабатывает триггер. По триггеру выполняются какие либо действия. Правила изначально прописываются в несколько веток разделенных по протоколам (TCP, UDP, ICMP и т.д.), как ветки INPUT, FORWARD и т.д. в iptables Linux. Действия правил описывают, то как демон должен прореагировать если правило совпало с трафиком. Каждое правило включает не только условия проверки трафика (порт, ip адрес, МАК адрес и т.п.), но и допустимый порог трафика (битрейт), который необходимо превысить для срабатывания триггера.

Функционал детектора DDoS атак:
- слушает 10Гб/сек SPAN порт с трафиком сети (входящий или весь)
- есть несколько предопределенных протоколов для ветвления правил-счетчиков (TCP, UDP, ICMP)
- есть TCP порт подключившись к которому можно (с помощью telnet/netcat): управлять правилами-счетчиками, управлять глобальными настройками
- демон реагирует на сигнал SIGHUP перечитывая конфиг правил
- в конфиге список правил-счетчиков, триггеры, условия реакции на триггеры
- если срабатывает триггер может: вызываться сторонний скрипт, передаваться анонс по BGP
- демон может получать и учитывать информацию NetFlow v9, либо SNMP счетчики. Для NetFlow и SNMP также создаются правила